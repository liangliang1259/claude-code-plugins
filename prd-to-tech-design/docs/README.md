# 架构图文档

本目录包含PRD转技术方案生成器插件的架构设计图。

## 图表说明

### 1. 插件架构图 (`plugin-architecture.svg`)

展示了插件的整体分层架构和组件关系：

**层级结构**：
- **用户层**：用户输入命令
- **命令层**：两个主要命令（generate-tech-design、config-feishu）
- **代理层**：PRD分析器和技术方案生成器
- **技能层**：可复用的PRD分析技能
- **工具库层**：Python工具库（飞书客户端、PRD解析器、工具函数、模板）

**数据流向**：
- 数据源（本地文件/飞书文档/粘贴内容）→ 命令层 → Agent层 → 工具库层 → 输出

### 2. 数据流程图 (`data-flow.svg`)

展示了从PRD输入到技术方案输出的完整处理流程：

**7个主要步骤**：
1. **用户输入PRD** - 选择3种输入方式之一
2. **PRD解析** - 使用prd_parser.py提取结构化数据
3. **PRD分析** - Agent提取需求、用户故事、约束
4. **技术方案生成** - Agent基于分析数据生成技术方案
5. **模板应用** - 使用tech_design_template.md填充内容
6. **图表生成** - 自动生成9种Mermaid图表
7. **输出文档** - 生成包含8个章节的完整技术设计文档

**输出内容**：
- 8个完整章节
- 9种Mermaid图表（系统架构图、ER图、流程图、部署图、甘特图等）
- 全中文内容

### 3. 组件交互时序图 (`component-interaction.svg`)

详细展示了各组件之间的交互时序和调用关系：

**主要交互流程**：
1. 用户调用命令
2. 命令询问输入来源
3. 用户提供PRD内容
4. 调用PRD解析器提取内容
5. 调用PRD分析Agent分析需求
6. 调用技术方案生成Agent
7. 读取技术设计模板
8. 生成8个章节内容
9. 生成Mermaid图表
10. 返回完整文档
11. 确认输出位置
12. 写入文件

**关键组件**：
- `generate-tech-design.md` - 主命令，协调整个流程
- `prd_parser.py` - PRD内容解析
- `prd-analyzer Agent` - 需求分析和提取
- `tech-design-generator Agent` - 技术方案生成
- `tech_design_template.md` - 输出模板

## 如何使用这些图表

### 在Markdown中引用

```markdown
### 插件架构

![插件架构](./docs/diagrams/plugin-architecture.svg)

### 数据流程

![数据流程](./docs/diagrams/data-flow.svg)

### 组件交互

![组件交互](./docs/diagrams/component-interaction.svg)
```

### 在网页中使用

SVG可以直接嵌入HTML：

```html
<img src="./docs/diagrams/plugin-architecture.svg" alt="插件架构图">
```

### 编辑SVG

这些SVG可以使用以下工具编辑：
- **Inkscape**（免费，开源）
- **Adobe Illustrator**（商业）
- **Figma**（在线设计工具）
- **Sketch**（Mac）

直接用文本编辑器也可以修改SVG内容（它们是XML格式）。

## 技术设计文档中的图表

插件生成的技术设计文档中使用的Mermaid图表类型：

1. **系统架构图** - 展示系统各层级关系
2. **核心流程图** - 展示业务处理流程
3. **数据流时序图** - 展示组件交互时序
4. **ER图** - 展示数据库实体关系
5. **部署架构图** - 展示基础设施部署
6. **CI/CD流程图** - 展示持续集成部署流程
7. **灾难恢复流程图** - 展示故障恢复流程
8. **甘特图** - 展示项目开发时间线

## 图表设计原则

这些架构图遵循以下设计原则：
- **清晰的层次结构** - 使用颜色区分不同层级
- **简洁的标注** - 使用中文标签，易于理解
- **标准的箭头** - 明确的数据流向和控制流
- **专业的配色** - 使用Material Design配色方案
- **可缩放格式** - SVG格式支持无损缩放

## 更新记录

- **2025-02-05**: 初始版本，创建3个核心架构图
  - 插件架构图
  - 数据流程图
  - 组件交互时序图
